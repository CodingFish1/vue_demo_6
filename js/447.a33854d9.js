"use strict";(self["webpackChunkvue_demo_6"]=self["webpackChunkvue_demo_6"]||[]).push([[447],{3447:function(e,t,l){l.r(t),l.d(t,{default:function(){return S}});var a=l(6252),s=l(3577),o=l(9963);const i={class:"container"},r={class:"text-end"},d=["disabled"],n={class:"table align-middle"},c=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th"),(0,a._)("th",null,"品名"),(0,a._)("th",{style:{width:"150px"}},"數量/單位"),(0,a._)("th",null,"單價")])],-1),m=["onClick"],u=(0,a.Uk)(" x "),p={class:"input-group input-group-sm"},h={class:"input-group mb-3"},f=["onUpdate:modelValue","onChange","disabled"],b=["value"],_={class:"input-group-text",id:"basic-addon2"},g={class:""},v=(0,a._)("small",{class:"text-success"},"折扣價：",-1),C=(0,a._)("td",{colspan:"3",class:"text-end"},"總計",-1),y={class:"text-end"};function w(e,t,l,w,k,x){const V=(0,a.up)("FormBody");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",i,[(0,a._)("div",r,[(0,a._)("button",{class:"btn btn-outline-danger",type:"button",onClick:t[0]||(t[0]=(...e)=>x.delCart&&x.delCart(...e)),disabled:0===k.cart.length},"清空購物車",8,d)]),(0,a._)("table",n,[c,(0,a._)("tbody",null,[k.cart?((0,a.wg)(!0),(0,a.iD)(a.HY,{key:0},(0,a.Ko)(k.cart,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.product.id},[(0,a._)("td",null,[(0,a._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:t=>x.delItem(e.id)},[(0,a._)("i",{class:(0,s.C_)(["fas fa-pulse",{"fa-spinner":k.isDeleting===e.id}])},null,2),u],8,m)]),(0,a._)("td",null,(0,s.zw)(e.product.title),1),(0,a._)("td",null,[(0,a._)("div",p,[(0,a._)("div",h,[(0,a.wy)((0,a._)("select",{id:"",class:"form select","onUpdate:modelValue":t=>e.qty=t,onChange:t=>x.updateCart(e),disabled:k.isLoading===e.id},[((0,a.wg)(),(0,a.iD)(a.HY,null,(0,a.Ko)(20,(e=>(0,a._)("option",{value:e,key:e},(0,s.zw)(e),9,b))),64))],40,f),[[o.bM,e.qty]]),(0,a._)("span",_,(0,s.zw)(e.product.unit),1)])])]),(0,a._)("td",g,[v,(0,a.Uk)(" "+(0,s.zw)(e.product.price),1)])])))),128)):(0,a.kq)("",!0)]),(0,a._)("tfoot",null,[(0,a._)("tr",null,[C,(0,a._)("td",y,(0,s.zw)(),1)])])])]),(0,a.Wm)(V,{onRefCart:x.getCart,cart:k.cart},null,8,["onRefCart","cart"])],64)}const k={class:"my-5 row justify-content-center"},x={class:"mb-3"},V=(0,a._)("label",{for:"email",class:"form-label"},"Email",-1),W={class:"mb-3"},q=(0,a._)("label",{for:"name",class:"form-label"},"收件人姓名",-1),D={class:"mb-3"},U=(0,a._)("label",{for:"tel",class:"form-label"},"收件人電話",-1),$={class:"mb-3"},z=(0,a._)("label",{for:"address",class:"form-label"},"收件人地址",-1),L={class:"mb-3"},O=(0,a._)("label",{for:"message",class:"form-label"},"留言",-1),j={class:"text-end"},F=["disabled"];function H(e,t,l,i,r,d){const n=(0,a.up)("v-field"),c=(0,a.up)("error-message"),m=(0,a.up)("v-form");return(0,a.wg)(),(0,a.iD)("div",k,[(0,a.Wm)(m,{ref:"form",class:"col-md-6",onSubmit:d.submitOrder},{default:(0,a.w5)((({errors:e})=>[(0,a._)("div",x,[V,(0,a.Wm)(n,{id:"email",name:"email",type:"email",class:(0,s.C_)(["form-control",{"is-invalid":e["email"]}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:r.form.user.email,"onUpdate:modelValue":t[0]||(t[0]=e=>r.form.user.email=e)},null,8,["class","modelValue"]),(0,a.Wm)(c,{name:"email",class:"invalid-feedback"})]),(0,a._)("div",W,[q,(0,a.Wm)(n,{id:"name",name:"姓名",type:"text",class:(0,s.C_)(["form-control",{"is-invalid":e["姓名"]}]),placeholder:"請輸入姓名",rules:"required",modelValue:r.form.user.name,"onUpdate:modelValue":t[1]||(t[1]=e=>r.form.user.name=e)},null,8,["class","modelValue"]),(0,a.Wm)(c,{name:"姓名",class:"invalid-feedback"})]),(0,a._)("div",D,[U,(0,a.Wm)(n,{id:"tel",name:"電話",type:"text",class:(0,s.C_)(["form-control",{"is-invalid":e["電話"]}]),placeholder:"請輸入電話",rules:"required|min:8|max:10",modelValue:r.form.user.tel,"onUpdate:modelValue":t[2]||(t[2]=e=>r.form.user.tel=e)},null,8,["class","modelValue"]),(0,a.Wm)(c,{name:"電話",class:"invalid-feedback"})]),(0,a._)("div",$,[z,(0,a.Wm)(n,{id:"address",name:"地址",type:"text",class:(0,s.C_)(["form-control",{"is-invalid":e["地址"]}]),placeholder:"請輸入地址",rules:"required",modelValue:r.form.user.address,"onUpdate:modelValue":t[3]||(t[3]=e=>r.form.user.address=e)},null,8,["class","modelValue"]),(0,a.Wm)(c,{name:"地址",class:"invalid-feedback"})]),(0,a._)("div",L,[O,(0,a.wy)((0,a._)("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":t[4]||(t[4]=e=>r.form.address=e)},null,512),[[o.nr,r.form.address]])]),(0,a._)("div",j,[(0,a._)("button",{type:"submit",class:"btn btn-danger",disabled:Object.keys(e).length>0||0===Object.keys(this.cart).length},"送出訂單",8,F)])])),_:1},8,["onSubmit"])])}var Y={data(){return{form:{user:{name:"",email:"",tel:"",address:""},message:""}}},props:["cart"],methods:{submitOrder(){const e=this.form;this.$http.post("https://vue3-course-api.hexschool.io/v2/api/williamone/order",{data:e}).then((e=>{console.log(e),this.$refs.form.resetForm(),this.form.message="",this.$emit("refCart")})).catch((e=>{console.dir(e)}))}},mounted(){}},B=l(3744);const E=(0,B.Z)(Y,[["render",H]]);var I=E,K={data(){return{cart:{},isLoading:"",isDeleting:""}},components:{FormBody:I},methods:{getCart(){this.$http.get("https://vue3-course-api.hexschool.io/v2/api/williamone/cart").then((e=>{this.cart=e.data.data.carts,console.log("Cart Loaded")})).catch((e=>{console.dir(e)}))},delCart(){this.$http.delete("https://vue3-course-api.hexschool.io/v2/api/williamone/carts").then((e=>{this.getCart()})).catch((e=>{console.dir(e)}))},delItem(e){this.isDeleting=e,console.log(e),this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/williamone/cart/${e}`).then((e=>{this.getCart(),this.isDeleting=""})).catch((e=>{console.dir(e)}))},updateCart(e){this.isLoading=e.id;const t={product_id:e.id,qty:e.qty};this.$http.put(`https://vue3-course-api.hexschool.io/v2/api/williamone/cart/${e.id}`,{data:t}).then((e=>{console.log(e),this.isLoading="",this.getCart()})).catch((e=>{console.dir(e)}))}},mounted(){this.getCart()}};const R=(0,B.Z)(K,[["render",w]]);var S=R}}]);
//# sourceMappingURL=447.a33854d9.js.map